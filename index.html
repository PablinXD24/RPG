<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>D&D Simplificado (M√©dia 5)</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;600;700&family=Lato:wght@300;400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-dark: #1a1f2e;
            --primary-medium: #2d3748;
            --primary-light: #4a5568;
            --accent-gold: #d4af37;
            --accent-burgundy: #8b0000;
            --accent-purple: #6b46c1;
            --text-light: #f7fafc;
            --text-medium: #e2e8f0;
            --text-dark: #2d3748;
            --card-bg: rgba(255, 255, 255, 0.95);
            --card-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            --border-radius: 12px;
            --transition: all 0.3s ease;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Lato', sans-serif;
            background: linear-gradient(135deg, var(--primary-dark) 0%, var(--primary-medium) 100%);
            color: var(--text-light);
            line-height: 1.6;
            padding: 15px;
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            position: relative;
        }

        header {
            text-align: center;
            padding: 25px 15px;
            margin-bottom: 25px;
            background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-burgundy) 50%, var(--accent-gold) 100%);
            border-radius: var(--border-radius);
            border: none;
            box-shadow: var(--card-shadow);
            position: relative;
            overflow: hidden;
        }

        header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" opacity="0.1"><rect fill="%23ffffff" width="100" height="100"/><path fill="%23000000" d="M0 0L100 100M100 0L0 100"/></svg>');
            z-index: 0;
        }

        h1 {
            font-family: 'Cinzel', serif;
            font-size: 1.8rem;
            color: var(--text-light);
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            margin-bottom: 8px;
            font-weight: 700;
            letter-spacing: 1px;
            position: relative;
            z-index: 1;
        }

        .subtitle {
            color: var(--text-medium);
            font-size: 1rem;
            font-style: italic;
            position: relative;
            z-index: 1;
        }

        .content-area {
            display: flex;
            flex-direction: column;
            gap: 20px;
            margin-bottom: 30px;
        }

        .rules-section, .character-section {
            background: var(--card-bg);
            padding: 20px;
            border-radius: var(--border-radius);
            border: none;
            box-shadow: var(--card-shadow);
            color: var(--text-dark);
            transition: var(--transition);
        }

        .rules-section:hover, .character-section:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 20px rgba(0,0,0,0.15);
        }

        h2 {
            font-family: 'Cinzel', serif;
            color: var(--accent-purple);
            margin-bottom: 15px;
            font-size: 1.4rem;
            border-bottom: 2px solid var(--accent-gold);
            padding-bottom: 8px;
            font-weight: 600;
        }

        h3 {
            font-family: 'Cinzel', serif;
            color: var(--accent-burgundy);
            margin: 12px 0 6px 0;
            font-size: 1.1rem;
            font-weight: 600;
        }

        .rule-card {
            background: rgba(255, 255, 255, 0.7);
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 15px;
            border-left: 4px solid var(--accent-purple);
            transition: var(--transition);
        }

        .rule-card:hover {
            background: rgba(255, 255, 255, 0.9);
            transform: translateX(3px);
        }

        .race-grid, .class-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 12px;
            margin: 12px 0;
        }

        .race-card, .class-card {
            background: rgba(255, 255, 255, 0.9);
            border: 2px solid var(--primary-light);
            border-radius: 8px;
            padding: 15px;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            flex-direction: column;
        }

        .race-card:hover, .class-card:hover {
            border-color: var(--accent-purple);
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(107, 70, 193, 0.2);
        }

        .race-card.selected, .class-card.selected {
            border-color: var(--accent-purple);
            background: rgba(107, 70, 193, 0.1);
            box-shadow: 0 6px 12px rgba(107, 70, 193, 0.3);
        }

        .attributes-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin: 15px 0;
        }

        .attribute-card {
            background: rgba(255, 255, 255, 0.9);
            border: 2px solid var(--primary-light);
            border-radius: 8px;
            padding: 12px;
            text-align: center;
            transition: var(--transition);
        }

        .attribute-card:hover {
            transform: scale(1.03);
            border-color: var(--accent-gold);
        }

        .attribute-value {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--accent-burgundy);
            margin: 5px 0;
        }

        .attribute-mod {
            font-size: 1rem;
            color: var(--accent-purple);
            font-weight: bold;
        }

        .character-sheet {
            background: rgba(255, 255, 255, 0.9);
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
            border: 2px solid var(--accent-gold);
            transition: var(--transition);
        }

        .sheet-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(139, 105, 20, 0.3);
        }

        .sheet-label {
            font-weight: bold;
            color: var(--accent-purple);
            font-size: 0.9rem;
        }

        .sheet-value {
            color: var(--text-dark);
            font-weight: 500;
            font-size: 0.9rem;
        }

        .combat-stats {
            display: grid;
            grid-template-columns: 1fr;
            gap: 15px;
            margin: 15px 0;
        }

        .combat-stat {
            background: rgba(255, 255, 255, 0.9);
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            border: 2px solid var(--accent-gold);
            transition: var(--transition);
        }

        .combat-stat:hover {
            transform: scale(1.02);
        }

        .stat-value {
            font-size: 1.8rem;
            font-weight: bold;
            color: var(--accent-burgundy);
        }

        .stat-label {
            font-size: 0.9rem;
            color: var(--accent-purple);
            font-weight: bold;
            margin-top: 5px;
        }

        button {
            padding: 12px 18px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: var(--transition);
            font-size: 0.9rem;
            background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-burgundy) 100%);
            color: white;
            margin: 5px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            font-family: 'Lato', sans-serif;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.3);
            background: linear-gradient(135deg, var(--accent-burgundy) 0%, var(--accent-gold) 100%);
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-gold) 100%);
            color: white;
            width: 100%;
            margin-top: 15px;
            padding: 14px;
            font-size: 1rem;
        }

        .hp-calculation {
            background: rgba(255, 255, 255, 0.8);
            padding: 12px;
            border-radius: 8px;
            margin: 12px 0;
            border-left: 4px solid var(--accent-gold);
            font-size: 0.85rem;
        }

        .calculation-breakdown {
            font-family: monospace;
            background: rgba(0,0,0,0.05);
            padding: 8px;
            border-radius: 4px;
            margin-top: 5px;
            font-size: 0.8rem;
        }

        .customization-section {
            background: rgba(255, 255, 255, 0.9);
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            border: 2px dashed var(--accent-purple);
        }

        .customization-options {
            display: grid;
            grid-template-columns: 1fr;
            gap: 10px;
            margin: 10px 0;
        }

        .customization-option {
            background: rgba(255, 255, 255, 0.9);
            border: 2px solid var(--primary-light);
            border-radius: 8px;
            padding: 12px;
            text-align: center;
            cursor: pointer;
            transition: var(--transition);
        }

        .customization-option:hover {
            border-color: var(--accent-purple);
            background: rgba(107, 70, 193, 0.1);
        }

        .customization-option.selected {
            border-color: var(--accent-purple);
            background: rgba(107, 70, 193, 0.2);
            box-shadow: 0 3px 8px rgba(107, 70, 193, 0.2);
        }

        .special-rule {
            background: rgba(255, 255, 255, 0.9);
            padding: 15px;
            border-radius: 8px;
            margin-top: 15px;
            border-left: 4px solid var(--accent-burgundy);
        }

        .calculator-section {
            background: var(--card-bg);
            padding: 20px;
            border-radius: var(--border-radius);
            border: none;
            box-shadow: var(--card-shadow);
            color: var(--text-dark);
            transition: var(--transition);
            margin-top: 25px;
        }

        .calculator-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 15px;
            margin-top: 15px;
        }

        .calculator-select {
            width: 100%;
            padding: 12px;
            border: 2px solid var(--primary-light);
            border-radius: 8px;
            background: white;
            font-family: 'Lato', sans-serif;
            font-size: 0.9rem;
            transition: var(--transition);
        }

        .calculator-select:focus {
            outline: none;
            border-color: var(--accent-purple);
            box-shadow: 0 0 0 3px rgba(107, 70, 193, 0.2);
        }

        .calculator-result {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 12px;
            font-weight: bold;
            font-size: 1rem;
        }

        .pv-result {
            background: rgba(239, 68, 68, 0.1);
            border: 2px solid rgba(239, 68, 68, 0.3);
            color: var(--accent-burgundy);
        }

        .ca-result {
            background: rgba(59, 130, 246, 0.1);
            border: 2px solid rgba(59, 130, 246, 0.3);
            color: var(--accent-purple);
        }

        .result-value {
            font-size: 1.6rem;
            font-weight: bold;
        }

        /* Menu mobile */
        .mobile-menu {
            display: none;
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: var(--primary-dark);
            padding: 10px;
            z-index: 1000;
            box-shadow: 0 -2px 10px rgba(0,0,0,0.3);
        }

        .mobile-menu button {
            flex: 1;
            margin: 0 5px;
            padding: 10px;
            font-size: 0.8rem;
        }

        /* Media Queries para tablets e desktops */
        @media (min-width: 768px) {
            body {
                padding: 20px;
            }
            
            header {
                padding: 30px 20px;
                margin-bottom: 30px;
            }
            
            h1 {
                font-size: 2.2rem;
            }
            
            .subtitle {
                font-size: 1.1rem;
            }
            
            .content-area {
                display: grid;
                grid-template-columns: 1fr 1fr;
                gap: 25px;
                margin-bottom: 40px;
            }
            
            .rules-section, .character-section {
                padding: 25px;
            }
            
            h2 {
                font-size: 1.5rem;
            }
            
            .race-grid, .class-grid {
                grid-template-columns: 1fr 1fr;
                gap: 15px;
            }
            
            .attributes-grid {
                grid-template-columns: repeat(5, 1fr);
            }
            
            .combat-stats {
                grid-template-columns: 1fr 1fr;
            }
            
            .customization-options {
                grid-template-columns: 1fr 1fr;
            }
            
            .calculator-grid {
                grid-template-columns: 1fr 1fr;
            }
            
            .calculator-section {
                grid-column: 1 / -1;
            }
        }

        @media (min-width: 1024px) {
            h1 {
                font-size: 2.8rem;
            }
            
            .content-area {
                gap: 30px;
            }
            
            .rules-section, .character-section {
                padding: 30px;
            }
        }

        /* Estilo para elementos de sele√ß√£o em dispositivos m√≥veis */
        select {
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
            background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%234a5568' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e");
            background-repeat: no-repeat;
            background-position: right 12px center;
            background-size: 16px;
            padding-right: 40px;
        }

        /* Melhorias de toque para dispositivos m√≥veis */
        @media (hover: none) {
            .race-card:hover, .class-card:hover,
            .attribute-card:hover, .combat-stat:hover,
            .rule-card:hover, .rules-section:hover,
            .character-section:hover, .calculator-section:hover {
                transform: none;
            }
            
            button:hover {
                transform: none;
            }
        }

        /* Ajustes para telas muito pequenas */
        @media (max-width: 360px) {
            body {
                padding: 10px;
            }
            
            header {
                padding: 20px 10px;
            }
            
            h1 {
                font-size: 1.6rem;
            }
            
            .rules-section, .character-section {
                padding: 15px;
            }
            
            .rule-card, .character-sheet, .special-rule {
                padding: 12px;
            }
        }

        /* PDF (mantido igual) */
        #pdf-sheet {
            background: white;
            padding: 30px;
            margin: 20px auto;
            max-width: 800px;
            border: 2px solid var(--accent-gold);
            box-shadow: 0 0 20px rgba(0,0,0,0.3);
            display: none;
        }

        .pdf-header {
            text-align: center;
            margin-bottom: 30px;
            border-bottom: 3px double var(--accent-gold);
            padding-bottom: 20px;
        }

        .pdf-section {
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--accent-gold);
        }

        .pdf-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin: 15px 0;
        }

        .pdf-attribute {
            text-align: center;
            padding: 10px;
            border: 1px solid var(--accent-gold);
            border-radius: 4px;
        }

        .pdf-combat-stats {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
            margin: 15px 0;
        }

        .pdf-combat-stat {
            text-align: center;
            padding: 15px;
            border: 2px solid var(--accent-gold);
            border-radius: 6px;
            background: #f9f5e8;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üé≤ D&D Simplificado (M√©dia 5)</h1>
            <div class="subtitle">Sistema de RPG simplificado com 5 habilidades e m√©dia 5</div>
        </header>
        
        <div class="content-area">
            <div class="rules-section">
                <h2>üìñ Regras do Sistema</h2>
                
                <div class="rule-card">
                    <h3>üéØ Sistema de Habilidades</h3>
                    <p>O sistema utiliza 5 habilidades principais:</p>
                    <ul>
                        <li><strong>FOR</strong> - For√ßa: Combate corpo a corpo, atletismo</li>
                        <li><strong>CON</strong> - Constitui√ß√£o: Vitalidade, resist√™ncia</li>
                        <li><strong>DES</strong> - Destreza: Agilidade, furtividade, reflexos</li>
                        <li><strong>MENTE</strong> - Intelig√™ncia/Sabedoria: Conhecimento, percep√ß√£o, magia</li>
                        <li><strong>CAR</strong> - Carisma: Persuas√£o, lideran√ßa, presen√ßa</li>
                    </ul>
                </div>

                <div class="rule-card">
                    <h3>üßÆ C√°lculo de Modificadores</h3>
                    <p><strong>Modificador = Valor da Habilidade Final - 5</strong></p>
                    <p>Exemplo: FOR 7 ‚Üí Modificador +2</p>
                </div>

                <div class="rule-card">
                    <h3>‚ù§Ô∏è Pontos de Vida (PV)</h3>
                    <p><strong>PV = 10 (Base) + B√¥nus de PV da Classe + Modificador de CON Final</strong></p>
                    <div class="hp-calculation">
                        <strong>Exemplo de c√°lculo:</strong>
                        <div class="calculation-breakdown">
                            Base: 10<br>
                            + B√¥nus Classe (Guerreiro): +6<br>
                            + Mod. CON (CON 6 ‚Üí +1): +1<br>
                            = <strong>17 PV</strong>
                        </div>
                    </div>
                </div>

                <div class="rule-card">
                    <h3>‚öîÔ∏è Sistema de Combate</h3>
                    <p><strong>Ataque:</strong> 1d20 + Modificador de habilidade + Profici√™ncia (se aplic√°vel)</p>
                    <p><strong>Dano:</strong> Varia pela arma + Modificador de habilidade</p>
                    <p><strong>Classe de Armadura (CA):</strong> 10 + Modificador de DES (limitado pela armadura) + B√¥nus da Armadura</p>
                </div>

                <div class="rule-card">
                    <h3>üõ°Ô∏è Sistema de Armaduras</h3>
                    <p><strong>Nenhuma (Roupas):</strong> B√¥nus CA: 0, Sem limite de DES</p>
                    <p><strong>Leve (Couro):</strong> B√¥nus CA: 2, Sem limite de DES</p>
                    <p><strong>M√©dia (Cota de Malha):</strong> B√¥nus CA: 4, Limite de DES: +1</p>
                    <p><strong>Pesada (Placas):</strong> B√¥nus CA: 6, Limite de DES: +0</p>
                </div>

                <h2>üë• Ra√ßas Dispon√≠veis</h2>
                <div class="race-grid" id="race-grid">
                    <!-- Ra√ßas ser√£o preenchidas por JavaScript -->
                </div>

                <h2>‚öîÔ∏è Classes Dispon√≠veis</h2>
                <div class="class-grid" id="class-grid">
                    <!-- Classes ser√£o preenchidas por JavaScript -->
                </div>
            </div>
            
            <div class="character-section">
                <h2>üë§ Criador de Personagem</h2>
                
                <div class="rule-card">
                    <h3>1. Escolha sua Ra√ßa</h3>
                    <p id="selected-race">Nenhuma ra√ßa selecionada</p>
                    <div id="race-customization" style="display: none;">
                        <!-- Customiza√ß√£o da ra√ßa ser√° preenchida por JavaScript -->
                    </div>
                </div>

                <div class="rule-card">
                    <h3>2. Escolha sua Classe</h3>
                    <p id="selected-class">Nenhuma classe selecionada</p>
                </div>

                <div class="rule-card">
                    <h3>3. Escolha sua Armadura</h3>
                    <select id="armor-select" class="calculator-select" onchange="updateCharacter()">
                        <option value="Nenhuma">Nenhuma (Roupas)</option>
                        <option value="Leve">Leve (Couro)</option>
                        <option value="Media" selected>M√©dia (Cota de Malha)</option>
                        <option value="Pesada">Pesada (Placas)</option>
                    </select>
                </div>

                <div class="rule-card">
                    <h3>4. Atributos do Personagem</h3>
                    <div class="attributes-grid" id="attributes-grid">
                        <!-- Atributos ser√£o preenchidos por JavaScript -->
                    </div>
                </div>

                <div class="character-sheet">
                    <h3>üìú Ficha do Personagem</h3>
                    
                    <div class="sheet-row">
                        <span class="sheet-label">Ra√ßa:</span>
                        <span class="sheet-value" id="sheet-race">---</span>
                    </div>
                    <div class="sheet-row">
                        <span class="sheet-label">Classe:</span>
                        <span class="sheet-value" id="sheet-class">---</span>
                    </div>
                    <div class="sheet-row">
                        <span class="sheet-label">Armadura:</span>
                        <span class="sheet-value" id="sheet-armor">---</span>
                    </div>
                    <div class="sheet-row">
                        <span class="sheet-label">N√≠vel:</span>
                        <span class="sheet-value">1</span>
                    </div>

                    <div class="combat-stats">
                        <div class="combat-stat">
                            <div class="stat-value" id="sheet-pv">---</div>
                            <div class="stat-label">PONTOS DE VIDA</div>
                        </div>
                        <div class="combat-stat">
                            <div class="stat-value" id="sheet-ca">---</div>
                            <div class="stat-label">CLASSE DE ARMADURA</div>
                        </div>
                    </div>

                    <div class="sheet-row">
                        <span class="sheet-label">For√ßa (FOR):</span>
                        <span class="sheet-value" id="sheet-for">---</span>
                    </div>
                    <div class="sheet-row">
                        <span class="sheet-label">Constitui√ß√£o (CON):</span>
                        <span class="sheet-value" id="sheet-con">---</span>
                    </div>
                    <div class="sheet-row">
                        <span class="sheet-label">Destreza (DES):</span>
                        <span class="sheet-value" id="sheet-des">---</span>
                    </div>
                    <div class="sheet-row">
                        <span class="sheet-label">Mente (MENTE):</span>
                        <span class="sheet-value" id="sheet-men">---</span>
                    </div>
                    <div class="sheet-row">
                        <span class="sheet-label">Carisma (CAR):</span>
                        <span class="sheet-value" id="sheet-car">---</span>
                    </div>

                    <div id="special-rule-container">
                        <!-- Regra especial ser√° preenchida por JavaScript -->
                    </div>

                    <button class="btn-primary" onclick="createCharacter()">
                        üé≤ Criar Personagem e Gerar PDF
                    </button>
                </div>
            </div>

            <div class="calculator-section">
                <h2>üßÆ Calculadora R√°pida</h2>
                <p>Use esta calculadora para testar rapidamente diferentes combina√ß√µes de ra√ßa, classe e armadura:</p>
                
                <div class="calculator-grid">
                    <div>
                        <label for="calc-race-select" class="sheet-label">Ra√ßa:</label>
                        <select id="calc-race-select" class="calculator-select" onchange="updateCalculator()">
                            <!-- Preenchido por JavaScript -->
                        </select>
                    </div>
                    <div>
                        <label for="calc-class-select" class="sheet-label">Classe:</label>
                        <select id="calc-class-select" class="calculator-select" onchange="updateCalculator()">
                            <!-- Preenchido por JavaScript -->
                        </select>
                    </div>
                    <div>
                        <label for="calc-armor-select" class="sheet-label">Armadura:</label>
                        <select id="calc-armor-select" class="calculator-select" onchange="updateCalculator()">
                            <option value="Nenhuma">Nenhuma (Roupas)</option>
                            <option value="Leve">Leve (Couro)</option>
                            <option value="Media" selected>M√©dia (Cota de Malha)</option>
                            <option value="Pesada">Pesada (Placas)</option>
                        </select>
                    </div>
                </div>
                
                <div class="calculator-result pv-result">
                    <span>‚ù§Ô∏è PV Total (Vida):</span>
                    <span class="result-value" id="calc-pv-result">--</span>
                </div>
                
                <div class="calculator-result ca-result">
                    <span>üõ°Ô∏è CA Final (Defesa):</span>
                    <span class="result-value" id="calc-ca-result">--</span>
                </div>
                
                <p class="text-sm text-gray-600 mt-4" style="font-size: 0.8rem; color: var(--primary-light); margin-top: 15px;">
                    *Nota: Esta calculadora usa APENAS a base da Ra√ßa e o b√¥nus FIXO da Classe. 
                    O b√¥nus opcional de customiza√ß√£o do jogador (+1 em X ou Y) n√£o est√° inclu√≠do.
                </p>
            </div>
        </div>
    </div>

    <!-- Menu Mobile -->
    <div class="mobile-menu" id="mobile-menu">
        <button onclick="scrollToSection('rules')">üìñ Regras</button>
        <button onclick="scrollToSection('character')">üë§ Personagem</button>
        <button onclick="scrollToSection('calculator')">üßÆ Calculadora</button>
    </div>

    <!-- Template para PDF (invis√≠vel na p√°gina principal) -->
    <div id="pdf-sheet">
        <div class="pdf-header">
            <h1>Ficha de Personagem - D&D Simplificado</h1>
            <p>Sistema M√©dia 5</p>
        </div>
        
        <div class="pdf-section">
            <h2>Informa√ß√µes B√°sicas</h2>
            <div class="pdf-grid">
                <div><strong>Nome:</strong> <span id="pdf-name">---</span></div>
                <div><strong>Ra√ßa:</strong> <span id="pdf-race">---</span></div>
                <div><strong>Classe:</strong> <span id="pdf-class">---</span></div>
                <div><strong>Armadura:</strong> <span id="pdf-armor">---</span></div>
                <div><strong>N√≠vel:</strong> 1</div>
            </div>
        </div>

        <div class="pdf-section">
            <h2>Atributos</h2>
            <div class="pdf-grid">
                <div class="pdf-attribute">
                    <strong>FOR√áA</strong><br>
                    <span id="pdf-for">---</span>
                </div>
                <div class="pdf-attribute">
                    <strong>CONSTITUI√á√ÉO</strong><br>
                    <span id="pdf-con">---</span>
                </div>
                <div class="pdf-attribute">
                    <strong>DESTREZA</strong><br>
                    <span id="pdf-des">---</span>
                </div>
                <div class="pdf-attribute">
                    <strong>MENTE</strong><br>
                    <span id="pdf-men">---</span>
                </div>
                <div class="pdf-attribute">
                    <strong>CARISMA</strong><br>
                    <span id="pdf-car">---</span>
                </div>
            </div>
        </div>

        <div class="pdf-section">
            <h2>Combate</h2>
            <div class="pdf-combat-stats">
                <div class="pdf-combat-stat">
                    <strong>PONTOS DE VIDA</strong><br>
                    <span style="font-size: 24px;" id="pdf-pv">---</span>
                </div>
                <div class="pdf-combat-stat">
                    <strong>CLASSE DE ARMADURA</strong><br>
                    <span style="font-size: 24px;" id="pdf-ca">---</span>
                </div>
                <div class="pdf-combat-stat">
                    <strong>INICIATIVA</strong><br>
                    <span style="font-size: 24px;" id="pdf-iniciativa">---</span>
                </div>
                <div class="pdf-combat-stat">
                    <strong>PROFICI√äNCIA</strong><br>
                    <span style="font-size: 24px;">+2</span>
                </div>
            </div>
        </div>

        <div class="pdf-section">
            <h2>Habilidade Especial</h2>
            <div id="pdf-special-rule">
                <p>---</p>
            </div>
        </div>

        <div class="pdf-section">
            <h2>C√°lculo de Pontos de Vida</h2>
            <div id="pdf-hp-calculation">
                <p>---</p>
            </div>
        </div>

        <div style="text-align: center; margin-top: 30px; font-style: italic; color: #666;">
            Personagem criado em D&D Simplificado (M√©dia 5)
        </div>
    </div>

    <script>
        // Dados do sistema baseados no JSON fornecido
        const systemData = {
            nome_sistema: "D&D Simplificado (M√©dia 5)",
            regras_base: {
                habilidades: ["FOR", "CON", "DES", "MENTE", "CAR"],
                calculo_modificador: "Valor da Habilidade Final - 5",
                ponto_neutro: 5,
                calculo_pv: "10 (Base) + B√¥nus de PV da Classe + Modificador de CON Final"
            },
            racas: [
                {
                    nome: "Humano",
                    atributos_base: { FOR: 5, CON: 5, DES: 5, MENTE: 5, CAR: 5 },
                    bonus_customizacao_jogador: "Adiciona +1 em DUAS HABILIDADES diferentes √† escolha do jogador."
                },
                {
                    nome: "Elfo",
                    atributos_base: { FOR: 4, CON: 5, DES: 6, MENTE: 7, CAR: 4 },
                    bonus_customizacao_jogador: "Adiciona +1 em MENTE OU +1 em DES √† escolha do jogador."
                },
                {
                    nome: "An√£o",
                    atributos_base: { FOR: 6, CON: 7, DES: 4, MENTE: 5, CAR: 4 },
                    bonus_customizacao_jogador: "Adiciona +1 em CON OU +1 em FOR √† escolha do jogador."
                },
                {
                    nome: "Orc",
                    atributos_base: { FOR: 8, CON: 6, DES: 3, MENTE: 3, CAR: 3 },
                    bonus_customizacao_jogador: "Adiciona +1 em FOR OU +1 em CON √† escolha do jogador."
                },
                {
                    nome: "Halfling",
                    atributos_base: { FOR: 4, CON: 4, DES: 7, MENTE: 6, CAR: 5 },
                    bonus_customizacao_jogador: "Adiciona +1 em DES OU +1 em CAR √† escolha do jogador."
                },
                {
                    nome: "Dem√¥nio",
                    atributos_base: { FOR: 5, CON: 5, DES: 4, MENTE: 7, CAR: 7 },
                    bonus_customizacao_jogador: "Adiciona +1 em CAR OU +1 em MENTE √† escolha do jogador."
                },
                {
                    nome: "Furries",
                    atributos_base: { FOR: 6, CON: 4, DES: 8, MENTE: 4, CAR: 6 },
                    bonus_customizacao_jogador: "Adiciona +1 em DES OU +1 em FOR √† escolha do jogador."
                }
            ],
            classes: [
                {
                    nome: "B√°rbaro",
                    bonus_atributos: { CON: 2, FOR: 1 },
                    nota_bonus_atributos: "B√¥nus fixo da Classe, que DEVE ser somado ap√≥s a customiza√ß√£o da Ra√ßa.",
                    bonus_pv: 8,
                    regra_unica: "F√∫ria: +3 Dano, Dano reduzido pela metade (1 uso/descanso)."
                },
                {
                    nome: "Guerreiro",
                    bonus_atributos: { FOR: 2, DES: 1 },
                    nota_bonus_atributos: "B√¥nus fixo da Classe, que DEVE ser somado ap√≥s a customiza√ß√£o da Ra√ßa.",
                    bonus_pv: 6,
                    regra_unica: "Ataque Extra: Duas vezes na mesma rodada (1 uso/descanso)."
                },
                {
                    nome: "Ladino",
                    bonus_atributos: { DES: 2, MENTE: 1 },
                    nota_bonus_atributos: "B√¥nus fixo da Classe, que DEVE ser somado ap√≥s a customiza√ß√£o da Ra√ßa.",
                    bonus_pv: 4,
                    regra_unica: "Ataque Furtivo: Dobro de dano se o inimigo estiver distra√≠do."
                },
                {
                    nome: "Cl√©rigo",
                    bonus_atributos: { MENTE: 2, CON: 1 },
                    nota_bonus_atributos: "B√¥nus fixo da Classe, que DEVE ser somado ap√≥s a customiza√ß√£o da Ra√ßa.",
                    bonus_pv: 4,
                    regra_unica: "Curar Feridas: Restaura 1d8 + Mod. MENTE PV (3 usos/descanso)."
                },
                {
                    nome: "Druida",
                    bonus_atributos: { MENTE: 2, CON: 1 },
                    nota_bonus_atributos: "B√¥nus fixo da Classe, que DEVE ser somado ap√≥s a customiza√ß√£o da Ra√ßa.",
                    bonus_pv: 4,
                    regra_unica: "Forma Animal: Transforma-se por 3 rodadas. Ganha +2 CON (1 uso/descanso)."
                },
                {
                    nome: "Art√≠fice",
                    bonus_atributos: { MENTE: 2, DES: 1 },
                    nota_bonus_atributos: "B√¥nus fixo da Classe, que DEVE ser somado ap√≥s a customiza√ß√£o da Ra√ßa.",
                    bonus_pv: 4,
                    regra_unica: "Infus√£o: Encanta arma/armadura para +1 no ataque/CA (1 uso/descanso)."
                },
                {
                    nome: "Feiticeiro",
                    bonus_atributos: { CAR: 3 },
                    nota_bonus_atributos: "B√¥nus fixo da Classe, que DEVE ser somado ap√≥s a customiza√ß√£o da Ra√ßa.",
                    bonus_pv: 2,
                    regra_unica: "Magia Pura: Pode relan√ßar um teste de Magia falho (1 uso/descanso)."
                },
                {
                    nome: "Mago",
                    bonus_atributos: { MENTE: 3 },
                    nota_bonus_atributos: "B√¥nus fixo da Classe, que DEVE ser somado ap√≥s a customiza√ß√£o da Ra√ßa.",
                    bonus_pv: 2,
                    regra_unica: "Magia Inteligente: Lan√ßa uma magia extra (Ataque/Defesa) (1 uso/descanso)."
                }
            ],
            armaduras: {
                "Nenhuma": { "bonus_ca": 0, "des_limite": 99, "display": "Nenhuma (Roupas)" },
                "Leve": { "bonus_ca": 2, "des_limite": 99, "display": "Leve (Couro)" },
                "Media": { "bonus_ca": 4, "des_limite": 1, "display": "M√©dia (Cota de Malha)" },
                "Pesada": { "bonus_ca": 6, "des_limite": 0, "display": "Pesada (Placas)" }
            }
        };

        // Estado do personagem
        let character = {
            race: null,
            class: null,
            armor: "Media",
            attributes: {
                FOR: 5,
                CON: 5,
                DES: 5,
                MENTE: 5,
                CAR: 5
            },
            name: "Aventureiro",
            raceCustomization: []
        };

        // Inicializa√ß√£o
        document.addEventListener('DOMContentLoaded', function() {
            populateRaces();
            populateClasses();
            populateAttributes();
            populateCalculatorSelectors();
            updateCharacterSheet();
            updateCalculator();
            
            // Mostrar menu mobile apenas em telas pequenas
            if (window.innerWidth < 768) {
                document.getElementById('mobile-menu').style.display = 'flex';
            }
            
            // Adicionar listener para redimensionamento da tela
            window.addEventListener('resize', function() {
                if (window.innerWidth < 768) {
                    document.getElementById('mobile-menu').style.display = 'flex';
                } else {
                    document.getElementById('mobile-menu').style.display = 'none';
                }
            });
        });

        // Fun√ß√£o para rolar para se√ß√µes espec√≠ficas (mobile)
        function scrollToSection(section) {
            let element;
            switch(section) {
                case 'rules':
                    element = document.querySelector('.rules-section');
                    break;
                case 'character':
                    element = document.querySelector('.character-section');
                    break;
                case 'calculator':
                    element = document.querySelector('.calculator-section');
                    break;
                default:
                    return;
            }
            
            if (element) {
                element.scrollIntoView({ behavior: 'smooth' });
            }
        }

        function populateRaces() {
            const raceGrid = document.getElementById('race-grid');
            raceGrid.innerHTML = '';
            
            systemData.racas.forEach(race => {
                const raceCard = document.createElement('div');
                raceCard.className = 'race-card';
                raceCard.innerHTML = `
                    <h3>${race.nome}</h3>
                    <p><small>
                        FOR: ${race.atributos_base.FOR} | 
                        CON: ${race.atributos_base.CON} | 
                        DES: ${race.atributos_base.DES} | 
                        MENTE: ${race.atributos_base.MENTE} | 
                        CAR: ${race.atributos_base.CAR}
                    </small></p>
                    <p style="font-size: 0.8rem; color: var(--accent-purple); margin-top: 5px;">
                        <strong>Customiza√ß√£o:</strong> ${race.bonus_customizacao_jogador}
                    </p>
                `;
                raceCard.addEventListener('click', () => selectRace(race));
                raceGrid.appendChild(raceCard);
            });
        }

        function populateClasses() {
            const classGrid = document.getElementById('class-grid');
            classGrid.innerHTML = '';
            
            systemData.classes.forEach(cls => {
                const classCard = document.createElement('div');
                classCard.className = 'class-card';
                
                let bonusText = '';
                Object.keys(cls.bonus_atributos).forEach(attr => {
                    bonusText += `${attr}: +${cls.bonus_atributos[attr]} `;
                });
                
                classCard.innerHTML = `
                    <h3>${cls.nome}</h3>
                    <p><small>B√¥nus: ${bonusText}</small></p>
                    <p><small>PV: +${cls.bonus_pv}</small></p>
                    <p><small>${cls.regra_unica}</small></p>
                    <p style="font-size: 0.7rem; color: var(--accent-burgundy); margin-top: 5px;">
                        <em>${cls.nota_bonus_atributos}</em>
                    </p>
                `;
                classCard.addEventListener('click', () => selectClass(cls));
                classGrid.appendChild(classCard);
            });
        }

        function populateCalculatorSelectors() {
            const calcRaceSelect = document.getElementById('calc-race-select');
            const calcClassSelect = document.getElementById('calc-class-select');
            
            // Preenche Ra√ßas
            systemData.racas.forEach(race => {
                const option = document.createElement('option');
                option.value = race.nome;
                option.textContent = race.nome;
                calcRaceSelect.appendChild(option);
            });
            calcRaceSelect.value = 'Humano';
            
            // Preenche Classes
            systemData.classes.forEach(charClass => {
                const option = document.createElement('option');
                option.value = charClass.nome;
                option.textContent = charClass.nome;
                calcClassSelect.appendChild(option);
            });
            calcClassSelect.value = 'Guerreiro';
        }

        function populateAttributes() {
            const attributesGrid = document.getElementById('attributes-grid');
            attributesGrid.innerHTML = '';
            
            systemData.regras_base.habilidades.forEach(attr => {
                const attributeCard = document.createElement('div');
                attributeCard.className = 'attribute-card';
                const mod = calculateModifier(character.attributes[attr]);
                
                attributeCard.innerHTML = `
                    <h3>${attr}</h3>
                    <div class="attribute-value">${character.attributes[attr]}</div>
                    <div class="attribute-mod">${mod >= 0 ? '+' + mod : mod}</div>
                `;
                
                attributesGrid.appendChild(attributeCard);
            });
        }

        function selectRace(race) {
            character.race = race;
            character.raceCustomization = [];
            
            // Atualizar atributos base da ra√ßa
            character.attributes = { ...race.atributos_base };
            
            // Atualizar sele√ß√£o visual
            document.querySelectorAll('.race-card').forEach(card => {
                card.classList.remove('selected');
            });
            event.currentTarget.classList.add('selected');
            
            // Atualizar display
            document.getElementById('selected-race').textContent = race.nome;
            
            // Mostrar op√ß√µes de customiza√ß√£o
            showRaceCustomization(race);
            
            populateAttributes();
            updateCharacterSheet();
            updateCalculator();
        }

        function showRaceCustomization(race) {
            const customizationContainer = document.getElementById('race-customization');
            customizationContainer.style.display = 'block';
            customizationContainer.innerHTML = `
                <div class="customization-section">
                    <h4>üéØ Customiza√ß√£o da Ra√ßa</h4>
                    <p>${race.bonus_customizacao_jogador}</p>
                    <div class="customization-options" id="customization-options">
                        ${generateCustomizationOptions(race)}
                    </div>
                </div>
            `;

            // Adicionar event listeners para as op√ß√µes de customiza√ß√£o
            document.querySelectorAll('.customization-option').forEach(option => {
                option.addEventListener('click', function() {
                    const selectedAttr = this.dataset.attribute;
                    handleCustomizationSelection(race, selectedAttr);
                });
            });
        }

        function generateCustomizationOptions(race) {
            let optionsHTML = '';
            
            if (race.nome === "Humano") {
                // Humano pode escolher duas habilidades diferentes
                systemData.regras_base.habilidades.forEach(attr => {
                    optionsHTML += `
                        <div class="customization-option" data-attribute="${attr}">
                            <strong>+1 ${attr}</strong>
                        </div>
                    `;
                });
            } else {
                // Outras ra√ßas t√™m op√ß√µes espec√≠ficas
                const options = race.bonus_customizacao_jogador.split('OU');
                options.forEach(option => {
                    const attr = option.match(/[A-Z]{2,}/)[0];
                    if (attr) {
                        optionsHTML += `
                            <div class="customization-option" data-attribute="${attr}">
                                <strong>${option.trim()}</strong>
                            </div>
                        `;
                    }
                });
            }
            
            return optionsHTML;
        }

        function handleCustomizationSelection(race, selectedAttr) {
            if (race.nome === "Humano") {
                // Humano pode selecionar at√© 2 habilidades diferentes
                if (character.raceCustomization.includes(selectedAttr)) {
                    // Desselecionar se j√° estiver selecionado
                    character.raceCustomization = character.raceCustomization.filter(attr => attr !== selectedAttr);
                } else if (character.raceCustomization.length < 2) {
                    // Selecionar se tiver menos de 2
                    character.raceCustomization.push(selectedAttr);
                } else {
                    alert('Como Humano, voc√™ pode selecionar apenas DUAS habilidades diferentes.');
                    return;
                }
            } else {
                // Outras ra√ßas selecionam apenas uma op√ß√£o
                character.raceCustomization = [selectedAttr];
            }
            
            // Atualizar sele√ß√£o visual
            document.querySelectorAll('.customization-option').forEach(option => {
                option.classList.remove('selected');
                if (character.raceCustomization.includes(option.dataset.attribute)) {
                    option.classList.add('selected');
                }
            });
            
            // Aplicar customiza√ß√£o aos atributos
            applyRaceCustomization();
            populateAttributes();
            updateCharacterSheet();
        }

        function applyRaceCustomization() {
            if (!character.race) return;
            
            // Reset para atributos base da ra√ßa
            character.attributes = { ...character.race.atributos_base };
            
            // Aplicar customiza√ß√£o
            character.raceCustomization.forEach(attr => {
                character.attributes[attr] += 1;
            });
            
            // Aplicar b√¥nus da classe se j√° selecionada
            if (character.class) {
                Object.keys(character.class.bonus_atributos).forEach(attr => {
                    character.attributes[attr] += character.class.bonus_atributos[attr];
                });
            }
        }

        function selectClass(cls) {
            character.class = cls;
            
            // Aplicar b√¥nus de classe aos atributos (ap√≥s customiza√ß√£o da ra√ßa)
            applyRaceCustomization();
            
            // Atualizar sele√ß√£o visual
            document.querySelectorAll('.class-card').forEach(card => {
                card.classList.remove('selected');
            });
            event.currentTarget.classList.add('selected');
            
            // Atualizar display
            document.getElementById('selected-class').textContent = cls.nome;
            populateAttributes();
            updateCharacterSheet();
            updateCalculator();
        }

        function updateCharacter() {
            character.armor = document.getElementById('armor-select').value;
            updateCharacterSheet();
        }

        function calculateModifier(value) {
            return value - systemData.regras_base.ponto_neutro;
        }

        function calculateHP() {
            if (!character.class) return { total: 10, breakdown: "Base: 10" };
            
            const conMod = calculateModifier(character.attributes.CON);
            const total = 10 + character.class.bonus_pv + conMod;
            const breakdown = `Base: 10 + B√¥nus Classe: ${character.class.bonus_pv} + Mod. CON: ${conMod} = ${total}`;
            
            return { total, breakdown };
        }

        function calculateCA() {
            const desMod = calculateModifier(character.attributes.DES);
            const armorData = systemData.armaduras[character.armor];
            
            if (!armorData) return 10 + desMod;
            
            // A contribui√ß√£o de DES √© o menor entre o Mod. DES real e o limite da armadura
            const desContribution = Math.min(desMod, armorData.des_limite);
            
            // CA Total = 10 + Contribui√ß√£o DES + B√¥nus Fixo Armadura
            return 10 + desContribution + armorData.bonus_ca;
        }

        function calculateIniciativa() {
            const desMod = calculateModifier(character.attributes.DES);
            return desMod;
        }

        function updateCharacterSheet() {
            if (character.race) {
                document.getElementById('sheet-race').textContent = character.race.nome;
            }
            
            if (character.class) {
                document.getElementById('sheet-class').textContent = character.class.nome;
            }
            
            document.getElementById('sheet-armor').textContent = systemData.armaduras[character.armor].display;
            
            // Atualizar atributos na ficha
            systemData.regras_base.habilidades.forEach(attr => {
                const value = character.attributes[attr];
                const mod = calculateModifier(value);
                const display = `${value} (${mod >= 0 ? '+' + mod : mod})`;
                document.getElementById(`sheet-${attr.toLowerCase()}`).textContent = display;
            });
            
            // Atualizar PV e CA
            const hp = calculateHP();
            document.getElementById('sheet-pv').textContent = hp.total;
            document.getElementById('sheet-ca').textContent = calculateCA();
            
            // Atualizar regra especial
            const specialRuleContainer = document.getElementById('special-rule-container');
            if (character.class) {
                specialRuleContainer.innerHTML = `
                    <div class="special-rule">
                        <h4>üéØ Regra Especial da Classe</h4>
                        <p>${character.class.regra_unica}</p>
                    </div>
                    <div class="hp-calculation">
                        <h4>‚ù§Ô∏è C√°lculo de Pontos de Vida</h4>
                        <div class="calculation-breakdown">${hp.breakdown}</div>
                    </div>
                `;
            } else {
                specialRuleContainer.innerHTML = '';
            }
        }

        // Fun√ß√µes para a calculadora r√°pida
        function getFinalAttributeValue(raceName, className, attribute) {
            const race = systemData.racas.find(r => r.nome === raceName);
            const charClass = systemData.classes.find(c => c.nome === className);

            if (!race || !charClass) return 0;

            let baseValue = race.atributos_base[attribute] || 0;
            let classBonus = charClass.bonus_atributos[attribute] || 0;

            return baseValue + classBonus;
        }

        function calculatePVForCalculator(raceName, className) {
            const charClass = systemData.classes.find(c => c.nome === className);
            if (!charClass) return 0;

            const conValue = getFinalAttributeValue(raceName, className, 'CON');
            const conMod = conValue - systemData.regras_base.ponto_neutro;
            const pvBonus = charClass.bonus_pv;

            return 10 + pvBonus + conMod;
        }

        function calculateCAForCalculator(raceName, className, armorType) {
            const armorData = systemData.armaduras[armorType];
            if (!armorData) return 0;

            const desValue = getFinalAttributeValue(raceName, className, 'DES');
            const desMod = desValue - systemData.regras_base.ponto_neutro;
            
            // A contribui√ß√£o de DES √© o menor entre o Mod. DES real e o limite da armadura
            const desContribution = Math.min(desMod, armorData.des_limite);
            
            // CA Total = 10 + Contribui√ß√£o DES + B√¥nus Fixo Armadura
            return 10 + desContribution + armorData.bonus_ca;
        }

        function updateCalculator() {
            const raceName = document.getElementById('calc-race-select').value;
            const className = document.getElementById('calc-class-select').value;
            const armorType = document.getElementById('calc-armor-select').value;

            // Calcular PV
            const pvResult = calculatePVForCalculator(raceName, className);
            document.getElementById('calc-pv-result').textContent = pvResult;

            // Calcular CA
            const caResult = calculateCAForCalculator(raceName, className, armorType);
            document.getElementById('calc-ca-result').textContent = caResult;
        }

        function createCharacter() {
            if (!character.race || !character.class) {
                alert('Por favor, selecione uma ra√ßa e uma classe!');
                return;
            }
            
            // Verificar customiza√ß√£o para Humanos
            if (character.race.nome === "Humano" && character.raceCustomization.length !== 2) {
                alert('Como Humano, voc√™ deve selecionar EXATAMENTE DUAS habilidades para customiza√ß√£o!');
                return;
            }
            
            // Verificar customiza√ß√£o para outras ra√ßas
            if (character.race.nome !== "Humano" && character.raceCustomization.length !== 1) {
                alert(`Por favor, selecione uma op√ß√£o de customiza√ß√£o para ${character.race.nome}!`);
                return;
            }
            
            // Perguntar nome do personagem
            const name = prompt('Digite o nome do seu personagem:', character.name);
            if (name) {
                character.name = name;
            }
            
            // Preparar dados para o PDF
            preparePDFData();
            
            // Gerar PDF
            generatePDF();
            
            alert(`üéâ Personagem "${character.name}" criado com sucesso!\n\nPDF gerado e pronto para download.`);
        }

        function preparePDFData() {
            const hp = calculateHP();
            const ca = calculateCA();
            const iniciativa = calculateIniciativa();
            
            // Preencher dados do PDF
            document.getElementById('pdf-name').textContent = character.name;
            document.getElementById('pdf-race').textContent = character.race.nome;
            document.getElementById('pdf-class').textContent = character.class.nome;
            document.getElementById('pdf-armor').textContent = systemData.armaduras[character.armor].display;
            
            // Atributos
            systemData.regras_base.habilidades.forEach(attr => {
                const value = character.attributes[attr];
                const mod = calculateModifier(value);
                const display = `${value} (${mod >= 0 ? '+' + mod : mod})`;
                document.getElementById(`pdf-${attr.toLowerCase()}`).textContent = display;
            });
            
            // Combate
            document.getElementById('pdf-pv').textContent = hp.total;
            document.getElementById('pdf-ca').textContent = ca;
            document.getElementById('pdf-iniciativa').textContent = iniciativa >= 0 ? `+${iniciativa}` : iniciativa;
            
            // Regra especial
            document.getElementById('pdf-special-rule').innerHTML = `<p>${character.class.regra_unica}</p>`;
            
            // C√°lculo de PV
            document.getElementById('pdf-hp-calculation').innerHTML = `<p>${hp.breakdown}</p>`;
        }

        function generatePDF() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            
            // Configura√ß√µes do PDF
            doc.setFont('helvetica');
            doc.setFontSize(20);
            doc.setTextColor(107, 70, 193);
            doc.text('Ficha de Personagem - D&D Simplificado', 105, 20, { align: 'center' });
            
            doc.setFontSize(12);
            doc.setTextColor(139, 105, 20);
            doc.text('Sistema M√©dia 5', 105, 28, { align: 'center' });
            
            // Linha decorativa
            doc.setDrawColor(139, 105, 20);
            doc.setLineWidth(0.5);
            doc.line(20, 35, 190, 35);
            
            // Informa√ß√µes b√°sicas
            doc.setFontSize(14);
            doc.setTextColor(107, 70, 193);
            doc.text('Informa√ß√µes B√°sicas', 20, 45);
            
            doc.setFontSize(10);
            doc.setTextColor(0, 0, 0);
            doc.text(`Nome: ${character.name}`, 20, 55);
            doc.text(`Ra√ßa: ${character.race.nome}`, 20, 62);
            doc.text(`Classe: ${character.class.nome}`, 100, 55);
            doc.text(`Armadura: ${systemData.armaduras[character.armor].display}`, 100, 62);
            doc.text(`N√≠vel: 1`, 20, 69);
            
            // Customiza√ß√£o da ra√ßa
            if (character.raceCustomization.length > 0) {
                let customizationText = "Customiza√ß√£o: ";
                if (character.race.nome === "Humano") {
                    customizationText += `+1 em ${character.raceCustomization.join(" e +1 em ")}`;
                } else {
                    customizationText += `+1 em ${character.raceCustomization[0]}`;
                }
                doc.text(customizationText, 20, 79);
            }
            
            // Atributos
            doc.setFontSize(14);
            doc.setTextColor(107, 70, 193);
            doc.text('Atributos', 20, 95);
            
            let yPos = 105;
            systemData.regras_base.habilidades.forEach(attr => {
                const value = character.attributes[attr];
                const mod = calculateModifier(value);
                const display = `${attr}: ${value} (${mod >= 0 ? '+' + mod : mod})`;
                doc.setFontSize(10);
                doc.setTextColor(0, 0, 0);
                doc.text(display, 20, yPos);
                yPos += 8;
            });
            
            // Combate
            doc.setFontSize(14);
            doc.setTextColor(107, 70, 193);
            doc.text('Combate', 20, 155);
            
            const hp = calculateHP();
            const ca = calculateCA();
            const iniciativa = calculateIniciativa();
            
            doc.setFontSize(10);
            doc.setTextColor(0, 0, 0);
            doc.text(`Pontos de Vida: ${hp.total}`, 20, 165);
            doc.text(`Classe de Armadura: ${ca}`, 20, 173);
            doc.text(`Iniciativa: ${iniciativa >= 0 ? '+' + iniciativa : iniciativa}`, 20, 181);
            doc.text(`Profici√™ncia: +2`, 20, 189);
            
            // Habilidade Especial
            doc.setFontSize(14);
            doc.setTextColor(107, 70, 193);
            doc.text('Habilidade Especial', 20, 205);
            
            doc.setFontSize(10);
            doc.setTextColor(0, 0, 0);
            const specialRuleLines = doc.splitTextToSize(character.class.regra_unica, 170);
            doc.text(specialRuleLines, 20, 215);
            
            // C√°lculo de PV
            let hpYPos = 215 + (specialRuleLines.length * 5) + 10;
            doc.setFontSize(14);
            doc.setTextColor(107, 70, 193);
            doc.text('C√°lculo de Pontos de Vida', 20, hpYPos);
            
            doc.setFontSize(10);
            doc.setTextColor(0, 0, 0);
            const hpLines = doc.splitTextToSize(hp.breakdown, 170);
            doc.text(hpLines, 20, hpYPos + 10);
            
            // Rodap√©
            doc.setFontSize(8);
            doc.setTextColor(102, 102, 102);
            doc.setFontStyle('italic');
            doc.text('Personagem criado em D&D Simplificado (M√©dia 5)', 105, 280, { align: 'center' });
            
            // Salvar PDF
            doc.save(`ficha-${character.name.replace(/\s+/g, '-').toLowerCase()}.pdf`);
        }
    </script>
</body>
</html>

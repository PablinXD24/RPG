<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>D&D Simplificado (M√©dia 5)</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;600;700&family=Lato:wght@300;400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-dark: #1a1f2e;
            --primary-medium: #2d3748;
            --primary-light: #4a5568;
            --accent-gold: #d4af37;
            --accent-burgundy: #8b0000;
            --accent-purple: #6b46c1;
            --text-light: #f7fafc;
            --text-medium: #e2e8f0;
            --text-dark: #2d3748;
            --card-bg: rgba(255, 255, 255, 0.95);
            --card-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            --border-radius: 10px;
            --transition: all 0.3s ease;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Lato', sans-serif;
            background: linear-gradient(135deg, var(--primary-dark) 0%, var(--primary-medium) 100%);
            color: var(--text-light);
            line-height: 1.5;
            padding: 12px;
            min-height: 100vh;
            font-size: 14px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            position: relative;
        }

        header {
            text-align: center;
            padding: 20px 12px;
            margin-bottom: 20px;
            background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-burgundy) 50%, var(--accent-gold) 100%);
            border-radius: var(--border-radius);
            border: none;
            box-shadow: var(--card-shadow);
            position: relative;
            overflow: hidden;
        }

        h1 {
            font-family: 'Cinzel', serif;
            font-size: 1.6rem;
            color: var(--text-light);
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            margin-bottom: 6px;
            font-weight: 700;
            letter-spacing: 0.5px;
        }

        .subtitle {
            color: var(--text-medium);
            font-size: 0.9rem;
            font-style: italic;
        }

        .content-area {
            display: flex;
            flex-direction: column;
            gap: 16px;
            margin-bottom: 70px;
        }

        .section-card {
            background: var(--card-bg);
            padding: 16px;
            border-radius: var(--border-radius);
            border: none;
            box-shadow: var(--card-shadow);
            color: var(--text-dark);
        }

        h2 {
            font-family: 'Cinzel', serif;
            color: var(--accent-purple);
            margin-bottom: 12px;
            font-size: 1.2rem;
            border-bottom: 2px solid var(--accent-gold);
            padding-bottom: 6px;
            font-weight: 600;
        }

        h3 {
            font-family: 'Cinzel', serif;
            color: var(--accent-burgundy);
            margin: 10px 0 5px 0;
            font-size: 1rem;
            font-weight: 600;
        }

        .rule-card {
            background: rgba(255, 255, 255, 0.7);
            padding: 12px;
            border-radius: 6px;
            margin-bottom: 12px;
            border-left: 3px solid var(--accent-purple);
        }

        .rule-card ul {
            padding-left: 18px;
        }

        .rule-card li {
            margin-bottom: 4px;
        }

        .compact-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 10px;
            margin: 10px 0;
        }

        .race-card, .class-card {
            background: rgba(255, 255, 255, 0.9);
            border: 1px solid var(--primary-light);
            border-radius: 6px;
            padding: 12px;
            cursor: pointer;
        }

        .race-card.selected, .class-card.selected {
            border-color: var(--accent-purple);
            background: rgba(107, 70, 193, 0.1);
        }

        .attributes-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
            margin: 12px 0;
        }

        .attribute-card {
            background: rgba(255, 255, 255, 0.9);
            border: 1px solid var(--primary-light);
            border-radius: 6px;
            padding: 10px;
            text-align: center;
        }

        .attribute-value {
            font-size: 1.3rem;
            font-weight: bold;
            color: var(--accent-burgundy);
            margin: 4px 0;
        }

        .attribute-mod {
            font-size: 0.9rem;
            color: var(--accent-purple);
            font-weight: bold;
        }

        .character-sheet {
            background: rgba(255, 255, 255, 0.9);
            padding: 16px;
            border-radius: 8px;
            margin-top: 16px;
            border: 2px solid var(--accent-gold);
        }

        .sheet-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            padding-bottom: 8px;
            border-bottom: 1px solid rgba(139, 105, 20, 0.3);
            font-size: 0.9rem;
        }

        .sheet-label {
            font-weight: bold;
            color: var(--accent-purple);
        }

        .combat-stats {
            display: grid;
            grid-template-columns: 1fr;
            gap: 12px;
            margin: 12px 0;
        }

        .combat-stat {
            background: rgba(255, 255, 255, 0.9);
            padding: 12px;
            border-radius: 6px;
            text-align: center;
            border: 2px solid var(--accent-gold);
        }

        .stat-value {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--accent-burgundy);
        }

        .stat-label {
            font-size: 0.8rem;
            color: var(--accent-purple);
            font-weight: bold;
            margin-top: 4px;
        }

        button {
            padding: 10px 14px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: bold;
            transition: var(--transition);
            font-size: 0.85rem;
            background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-burgundy) 100%);
            color: white;
            margin: 4px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
            font-family: 'Lato', sans-serif;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-gold) 100%);
            color: white;
            width: 100%;
            margin-top: 12px;
            padding: 12px;
            font-size: 0.9rem;
        }

        .hp-calculation {
            background: rgba(255, 255, 255, 0.8);
            padding: 10px;
            border-radius: 6px;
            margin: 10px 0;
            border-left: 3px solid var(--accent-gold);
            font-size: 0.8rem;
        }

        .calculation-breakdown {
            font-family: monospace;
            background: rgba(0,0,0,0.05);
            padding: 6px;
            border-radius: 4px;
            margin-top: 4px;
            font-size: 0.75rem;
        }

        .customization-section {
            background: rgba(255, 255, 255, 0.9);
            padding: 12px;
            border-radius: 6px;
            margin: 12px 0;
            border: 1px dashed var(--accent-purple);
        }

        .customization-options {
            display: grid;
            grid-template-columns: 1fr;
            gap: 8px;
            margin: 8px 0;
        }

        .customization-option {
            background: rgba(255, 255, 255, 0.9);
            border: 1px solid var(--primary-light);
            border-radius: 6px;
            padding: 10px;
            text-align: center;
            cursor: pointer;
            font-size: 0.85rem;
        }

        .customization-option.selected {
            border-color: var(--accent-purple);
            background: rgba(107, 70, 193, 0.2);
        }

        .special-rule {
            background: rgba(255, 255, 255, 0.9);
            padding: 12px;
            border-radius: 6px;
            margin-top: 12px;
            border-left: 3px solid var(--accent-burgundy);
            font-size: 0.85rem;
        }

        /* Sistema de Peso Compacto */
        .weight-info {
            display: grid;
            grid-template-columns: 1fr;
            gap: 10px;
            margin: 10px 0;
        }

        .weight-stat {
            background: rgba(255, 255, 255, 0.9);
            padding: 10px;
            border-radius: 6px;
            text-align: center;
            border: 1px solid var(--accent-gold);
        }

        .weight-bar-container {
            background: #e2e8f0;
            border-radius: 8px;
            height: 16px;
            margin: 8px 0;
            overflow: hidden;
        }

        .weight-bar {
            height: 100%;
            border-radius: 8px;
            transition: width 0.5s ease;
        }

        .weight-bar.leve { background: #48bb78; }
        .weight-bar.medio { background: #ed8936; }
        .weight-bar.pesado { background: #e53e3e; }
        .weight-bar.imovel { background: #805ad5; }

        .weight-limits {
            display: grid;
            grid-template-columns: 1fr;
            gap: 8px;
            margin: 12px 0;
        }

        .weight-limit {
            background: rgba(255, 255, 255, 0.8);
            padding: 10px;
            border-radius: 6px;
            border-left: 3px solid var(--accent-purple);
            font-size: 0.8rem;
        }

        .inventory-section {
            margin-top: 16px;
        }

        .inventory-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px;
            background: rgba(255, 255, 255, 0.8);
            border-radius: 4px;
            margin-bottom: 6px;
            font-size: 0.85rem;
        }

        .item-controls {
            display: flex;
            gap: 6px;
        }

        .item-controls button {
            padding: 4px 8px;
            font-size: 0.75rem;
            margin: 0;
        }

        .add-item-form {
            display: grid;
            grid-template-columns: 1fr;
            gap: 8px;
            margin-top: 12px;
        }

        .add-item-form input {
            padding: 8px;
            border: 1px solid var(--primary-light);
            border-radius: 4px;
            font-family: 'Lato', sans-serif;
            font-size: 0.85rem;
        }

        .add-item-form button {
            margin: 0;
        }

        .empty-inventory {
            text-align: center;
            padding: 20px;
            color: var(--primary-light);
            font-style: italic;
        }

        /* Calculadora */
        .calculator-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 10px;
            margin: 12px 0;
        }

        .calculator-result {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px;
            border-radius: 6px;
            margin-bottom: 10px;
            font-weight: bold;
            font-size: 0.9rem;
        }

        .pv-result {
            background: rgba(239, 68, 68, 0.1);
            border: 2px solid rgba(239, 68, 68, 0.3);
            color: var(--accent-burgundy);
        }

        .ca-result {
            background: rgba(59, 130, 246, 0.1);
            border: 2px solid rgba(59, 130, 246, 0.3);
            color: var(--accent-purple);
        }

        .result-value {
            font-size: 1.4rem;
            font-weight: bold;
        }

        /* Menu mobile melhorado */
        .mobile-menu {
            display: flex;
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: var(--primary-dark);
            padding: 8px;
            z-index: 1000;
            box-shadow: 0 -2px 10px rgba(0,0,0,0.3);
            border-top: 1px solid var(--accent-gold);
        }

        .mobile-menu button {
            flex: 1;
            margin: 0 4px;
            padding: 8px 4px;
            font-size: 0.75rem;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 2px;
        }

        .mobile-menu button span {
            font-size: 0.7rem;
        }

        /* Seletores mobile */
        select {
            width: 100%;
            padding: 10px;
            border: 1px solid var(--primary-light);
            border-radius: 6px;
            background: white;
            font-family: 'Lato', sans-serif;
            font-size: 0.85rem;
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
            background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%234a5568' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e");
            background-repeat: no-repeat;
            background-position: right 10px center;
            background-size: 14px;
            padding-right: 35px;
        }

        /* Media Queries para tablets */
        @media (min-width: 768px) {
            body {
                padding: 16px;
                font-size: 16px;
            }
            
            header {
                padding: 25px 16px;
                margin-bottom: 25px;
            }
            
            h1 {
                font-size: 2rem;
            }
            
            .subtitle {
                font-size: 1rem;
            }
            
            .content-area {
                display: grid;
                grid-template-columns: 1fr 1fr;
                gap: 20px;
                margin-bottom: 25px;
            }
            
            .section-card {
                padding: 20px;
            }
            
            .weight-section, .calculator-section {
                grid-column: 1 / -1;
            }
            
            h2 {
                font-size: 1.4rem;
            }
            
            .compact-grid {
                grid-template-columns: 1fr 1fr;
                gap: 12px;
            }
            
            .attributes-grid {
                grid-template-columns: repeat(5, 1fr);
            }
            
            .combat-stats {
                grid-template-columns: 1fr 1fr;
            }
            
            .customization-options {
                grid-template-columns: 1fr 1fr;
            }
            
            .weight-info {
                grid-template-columns: repeat(3, 1fr);
            }
            
            .weight-limits {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .add-item-form {
                grid-template-columns: 2fr 1fr 1fr;
            }
            
            .calculator-grid {
                grid-template-columns: 1fr 1fr;
            }
            
            .mobile-menu {
                display: none;
            }
        }

        @media (min-width: 1024px) {
            .content-area {
                grid-template-columns: 1fr 1fr;
                gap: 25px;
            }
            
            .section-card {
                padding: 25px;
            }
            
            .weight-limits {
                grid-template-columns: repeat(4, 1fr);
            }
        }

        /* Utilit√°rios para mobile */
        .text-small {
            font-size: 0.8rem;
        }

        .text-xsmall {
            font-size: 0.75rem;
        }

        .mb-1 { margin-bottom: 8px; }
        .mb-2 { margin-bottom: 12px; }
        .mt-1 { margin-top: 8px; }
        .mt-2 { margin-top: 12px; }

        /* Ajustes para telas muito pequenas */
        @media (max-width: 360px) {
            body {
                padding: 8px;
                font-size: 13px;
            }
            
            header {
                padding: 16px 8px;
            }
            
            h1 {
                font-size: 1.4rem;
            }
            
            .section-card {
                padding: 12px;
            }
            
            .rule-card, .character-sheet, .special-rule {
                padding: 10px;
            }
            
            .attributes-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        /* Remove hover effects on touch devices */
        @media (hover: none) {
            button:hover, .race-card:hover, .class-card:hover,
            .attribute-card:hover, .combat-stat:hover,
            .rule-card:hover {
                transform: none;
            }
        }

        /* PDF (oculto na visualiza√ß√£o principal) */
        #pdf-sheet {
            display: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üé≤ D&D Simplificado</h1>
            <div class="subtitle">Sistema M√©dia 5 - Mobile</div>
        </header>
        
        <div class="content-area">
            <!-- Regras -->
            <div class="section-card rules-section">
                <h2>üìñ Regras do Sistema</h2>
                
                <div class="rule-card">
                    <h3>üéØ Habilidades</h3>
                    <ul>
                        <li><strong>FOR</strong> - For√ßa</li>
                        <li><strong>CON</strong> - Constitui√ß√£o</li>
                        <li><strong>DES</strong> - Destreza</li>
                        <li><strong>MENTE</strong> - Intelig√™ncia/Sabedoria</li>
                        <li><strong>CAR</strong> - Carisma</li>
                    </ul>
                </div>

                <div class="rule-card">
                    <h3>üßÆ Modificadores</h3>
                    <p><strong>Modificador = Valor Final - 5</strong></p>
                    <p class="text-small">Ex: FOR 7 ‚Üí Mod +2</p>
                </div>

                <div class="rule-card">
                    <h3>‚ù§Ô∏è Pontos de Vida</h3>
                    <p><strong>PV = 10 + B√¥nus Classe + Mod. CON</strong></p>
                </div>

                <div class="rule-card">
                    <h3>üõ°Ô∏è Armaduras</h3>
                    <p class="text-small"><strong>Leve:</strong> CA +2, DES livre</p>
                    <p class="text-small"><strong>M√©dia:</strong> CA +4, DES +1</p>
                    <p class="text-small"><strong>Pesada:</strong> CA +6, DES +0</p>
                </div>

                <h3 class="mt-2">üë• Ra√ßas</h3>
                <div class="compact-grid" id="race-grid">
                    <!-- Preenchido por JS -->
                </div>

                <h3 class="mt-2">‚öîÔ∏è Classes</h3>
                <div class="compact-grid" id="class-grid">
                    <!-- Preenchido por JS -->
                </div>
            </div>
            
            <!-- Personagem -->
            <div class="section-card character-section">
                <h2>üë§ Criar Personagem</h2>
                
                <div class="rule-card">
                    <h3>1. Ra√ßa</h3>
                    <p id="selected-race" class="text-small">Nenhuma selecionada</p>
                    <div id="race-customization" style="display: none;"></div>
                </div>

                <div class="rule-card">
                    <h3>2. Classe</h3>
                    <p id="selected-class" class="text-small">Nenhuma selecionada</p>
                </div>

                <div class="rule-card">
                    <h3>3. Armadura</h3>
                    <select id="armor-select" onchange="updateCharacter()">
                        <option value="Nenhuma">Nenhuma</option>
                        <option value="Leve">Leve</option>
                        <option value="Media" selected>M√©dia</option>
                        <option value="Pesada">Pesada</option>
                    </select>
                </div>

                <div class="rule-card">
                    <h3>4. Atributos</h3>
                    <div class="attributes-grid" id="attributes-grid">
                        <!-- Preenchido por JS -->
                    </div>
                </div>

                <div class="character-sheet">
                    <h3>üìú Ficha</h3>
                    
                    <div class="sheet-row">
                        <span class="sheet-label">Ra√ßa:</span>
                        <span id="sheet-race">---</span>
                    </div>
                    <div class="sheet-row">
                        <span class="sheet-label">Classe:</span>
                        <span id="sheet-class">---</span>
                    </div>

                    <div class="combat-stats">
                        <div class="combat-stat">
                            <div class="stat-value" id="sheet-pv">---</div>
                            <div class="stat-label">PONTOS DE VIDA</div>
                        </div>
                        <div class="combat-stat">
                            <div class="stat-value" id="sheet-ca">---</div>
                            <div class="stat-label">CLASSE ARMADURA</div>
                        </div>
                    </div>

                    <div id="special-rule-container" class="mt-1"></div>

                    <button class="btn-primary" onclick="createCharacter()">
                        üé≤ Criar Personagem (PDF)
                    </button>
                </div>
            </div>

            <!-- Calculadora de Vida e Armadura -->
            <div class="section-card calculator-section">
                <h2>üßÆ Calculadora R√°pida</h2>
                <p class="text-small mb-2">Teste combina√ß√µes de ra√ßa, classe e armadura</p>
                
                <div class="calculator-grid">
                    <div>
                        <label class="sheet-label">Ra√ßa:</label>
                        <select id="calc-race-select" onchange="updateCalculator()">
                            <!-- Preenchido por JS -->
                        </select>
                    </div>
                    <div>
                        <label class="sheet-label">Classe:</label>
                        <select id="calc-class-select" onchange="updateCalculator()">
                            <!-- Preenchido por JS -->
                        </select>
                    </div>
                    <div>
                        <label class="sheet-label">Armadura:</label>
                        <select id="calc-armor-select" onchange="updateCalculator()">
                            <option value="Nenhuma">Nenhuma</option>
                            <option value="Leve">Leve</option>
                            <option value="Media" selected>M√©dia</option>
                            <option value="Pesada">Pesada</option>
                        </select>
                    </div>
                </div>
                
                <div class="calculator-result pv-result">
                    <span>‚ù§Ô∏è PV Total:</span>
                    <span class="result-value" id="calc-pv-result">--</span>
                </div>
                
                <div class="calculator-result ca-result">
                    <span>üõ°Ô∏è CA Final:</span>
                    <span class="result-value" id="calc-ca-result">--</span>
                </div>

                <div class="hp-calculation mt-2">
                    <h4>üìä Detalhes do C√°lculo</h4>
                    <div class="calculation-breakdown">
                        <div><strong>PV:</strong> 10 + B√¥nus Classe + Mod. CON</div>
                        <div><strong>CA:</strong> 10 + Mod. DES (limitado) + B√¥nus Armadura</div>
                    </div>
                </div>
            </div>

            <!-- Sistema de Peso -->
            <div class="section-card weight-section">
                <h2>‚öñÔ∏è Sistema de Peso</h2>
                
                <div class="rule-card">
                    <h3>üìä Carga</h3>
                    <p><strong>LMC = FOR√áA √ó 7.5 kg</strong></p>
                    <p class="text-small">Peso Total = Soma dos itens</p>
                </div>

                <div class="weight-info">
                    <div class="weight-stat">
                        <div class="stat-label">FOR√áA</div>
                        <div class="stat-value" id="weight-str">---</div>
                    </div>
                    <div class="weight-stat">
                        <div class="stat-label">LMC</div>
                        <div class="stat-value" id="weight-lmc">--- kg</div>
                    </div>
                    <div class="weight-stat">
                        <div class="stat-label">PESO</div>
                        <div class="stat-value" id="weight-current">--- kg</div>
                    </div>
                </div>

                <div class="weight-stat">
                    <div class="stat-label" id="weight-status">---</div>
                    <div class="weight-bar-container">
                        <div class="weight-bar" id="weight-bar"></div>
                    </div>
                    <div id="weight-penalty" class="text-xsmall mt-1"></div>
                </div>

                <div class="weight-limits">
                    <div class="weight-limit">
                        <h4>üèÉ Leve</h4>
                        <p class="text-small">At√© LMC √∑ 3</p>
                        <p class="text-xsmall" id="weight-light-example">--- kg</p>
                        <p class="text-xsmall">Sem penalidades</p>
                    </div>
                    <div class="weight-limit">
                        <h4>üö∂ M√©dio</h4>
                        <p class="text-small">At√© LMC √ó 2/3</p>
                        <p class="text-xsmall" id="weight-medium-example">--- kg</p>
                        <p class="text-xsmall">-3m movimento, -2 DES</p>
                    </div>
                    <div class="weight-limit">
                        <h4>üê¢ Pesado</h4>
                        <p class="text-small">At√© LMC</p>
                        <p class="text-xsmall" id="weight-heavy-example">--- kg</p>
                        <p class="text-xsmall">1.5m, desvantagem</p>
                    </div>
                    <div class="weight-limit">
                        <h4>üö´ Im√≥vel</h4>
                        <p class="text-small">Acima de LMC</p>
                        <p class="text-xsmall">N√£o pode se mover</p>
                    </div>
                </div>

                <div class="inventory-section">
                    <h3>üéí Invent√°rio</h3>
                    <div id="inventory-items" class="mb-1">
                        <div class="empty-inventory">
                            <p>üéÅ Invent√°rio vazio</p>
                            <p class="text-xsmall mt-1">Adicione itens usando o formul√°rio abaixo</p>
                        </div>
                    </div>
                    
                    <div class="add-item-form">
                        <input type="text" id="item-name" placeholder="Nome do item">
                        <input type="number" id="item-weight" placeholder="Peso (kg)" step="0.1" min="0">
                        <button onclick="addItem()">Adicionar</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Menu Mobile -->
    <div class="mobile-menu">
        <button onclick="scrollToSection('rules')">
            üìñ <span>Regras</span>
        </button>
        <button onclick="scrollToSection('character')">
            üë§ <span>Personagem</span>
        </button>
        <button onclick="scrollToSection('calculator')">
            üßÆ <span>Calculadora</span>
        </button>
        <button onclick="scrollToSection('weight')">
            ‚öñÔ∏è <span>Peso</span>
        </button>
        <button onclick="createCharacter()">
            üé≤ <span>PDF</span>
        </button>
    </div>

    <!-- Template PDF (oculto) -->
    <div id="pdf-sheet" style="display:none;"></div>

    <script>
        // Dados do sistema (vers√£o compacta para mobile)
        const systemData = {
            racas: [
                { 
                    nome: "Humano", 
                    atributos_base: { FOR: 5, CON: 5, DES: 5, MENTE: 5, CAR: 5 },
                    bonus_customizacao_jogador: "+1 em DUAS habilidades"
                },
                { 
                    nome: "Elfo", 
                    atributos_base: { FOR: 4, CON: 5, DES: 6, MENTE: 7, CAR: 4 },
                    bonus_customizacao_jogador: "+1 em MENTE ou DES"
                },
                { 
                    nome: "An√£o", 
                    atributos_base: { FOR: 6, CON: 7, DES: 4, MENTE: 5, CAR: 4 },
                    bonus_customizacao_jogador: "+1 em CON ou FOR"
                },
                { 
                    nome: "Orc", 
                    atributos_base: { FOR: 8, CON: 6, DES: 3, MENTE: 3, CAR: 3 },
                    bonus_customizacao_jogador: "+1 em FOR ou CON"
                },
                { 
                    nome: "Halfling", 
                    atributos_base: { FOR: 4, CON: 4, DES: 7, MENTE: 6, CAR: 5 },
                    bonus_customizacao_jogador: "+1 em DES ou CAR"
                }
            ],
            classes: [
                { 
                    nome: "Guerreiro", 
                    bonus_atributos: { FOR: 2, DES: 1 }, 
                    bonus_pv: 6, 
                    regra_unica: "Ataque Extra (1 uso/descanso)" 
                },
                { 
                    nome: "Ladino", 
                    bonus_atributos: { DES: 2, MENTE: 1 }, 
                    bonus_pv: 4, 
                    regra_unica: "Ataque Furtivo (dano dobrado)" 
                },
                { 
                    nome: "Mago", 
                    bonus_atributos: { MENTE: 3 }, 
                    bonus_pv: 2, 
                    regra_unica: "Magia Extra (1 uso/descanso)" 
                },
                { 
                    nome: "Cl√©rigo", 
                    bonus_atributos: { MENTE: 2, CON: 1 }, 
                    bonus_pv: 4, 
                    regra_unica: "Curar Feridas (3 usos)" 
                },
                { 
                    nome: "B√°rbaro", 
                    bonus_atributos: { CON: 2, FOR: 1 }, 
                    bonus_pv: 8, 
                    regra_unica: "F√∫ria (+3 dano, redu√ß√£o)" 
                }
            ],
            armaduras: {
                "Nenhuma": { bonus_ca: 0, des_limite: 99, display: "Nenhuma" },
                "Leve": { bonus_ca: 2, des_limite: 99, display: "Leve" },
                "Media": { bonus_ca: 4, des_limite: 1, display: "M√©dia" },
                "Pesada": { bonus_ca: 6, des_limite: 0, display: "Pesada" }
            }
        };

        // Estado do personagem - INVENT√ÅRIO VAZIO
        let character = {
            race: null,
            class: null,
            armor: "Media",
            attributes: { FOR: 5, CON: 5, DES: 5, MENTE: 5, CAR: 5 },
            name: "Aventureiro",
            raceCustomization: [],
            inventory: [] // Invent√°rio come√ßa vazio
        };

        // Inicializa√ß√£o
        document.addEventListener('DOMContentLoaded', function() {
            populateRaces();
            populateClasses();
            populateAttributes();
            populateCalculatorSelectors();
            updateCharacterSheet();
            updateCalculator();
            updateWeightSystem();
        });

        // Fun√ß√µes de navega√ß√£o mobile
        function scrollToSection(section) {
            const element = document.querySelector(`.${section}-section`);
            if (element) {
                element.scrollIntoView({ behavior: 'smooth' });
            }
        }

        // Fun√ß√µes do sistema
        function populateRaces() {
            const raceGrid = document.getElementById('race-grid');
            systemData.racas.forEach(race => {
                const card = document.createElement('div');
                card.className = 'race-card';
                card.innerHTML = `
                    <h4>${race.nome}</h4>
                    <p class="text-xsmall">FOR ${race.atributos_base.FOR} | CON ${race.atributos_base.CON} | DES ${race.atributos_base.DES}</p>
                    <p class="text-xsmall" style="color: var(--accent-purple); margin-top: 4px;">${race.bonus_customizacao_jogador}</p>
                `;
                card.onclick = () => selectRace(race);
                raceGrid.appendChild(card);
            });
        }

        function populateClasses() {
            const classGrid = document.getElementById('class-grid');
            systemData.classes.forEach(cls => {
                const card = document.createElement('div');
                card.className = 'class-card';
                card.innerHTML = `
                    <h4>${cls.nome}</h4>
                    <p class="text-xsmall">PV +${cls.bonus_pv}</p>
                    <p class="text-xsmall" style="color: var(--accent-burgundy); margin-top: 4px;">${cls.regra_unica}</p>
                `;
                card.onclick = () => selectClass(cls);
                classGrid.appendChild(card);
            });
        }

        function populateCalculatorSelectors() {
            const raceSelect = document.getElementById('calc-race-select');
            const classSelect = document.getElementById('calc-class-select');
            
            systemData.racas.forEach(race => {
                const option = document.createElement('option');
                option.value = race.nome;
                option.textContent = race.nome;
                raceSelect.appendChild(option);
            });
            
            systemData.classes.forEach(cls => {
                const option = document.createElement('option');
                option.value = cls.nome;
                option.textContent = cls.nome;
                classSelect.appendChild(option);
            });
            
            raceSelect.value = 'Humano';
            classSelect.value = 'Guerreiro';
        }

        function populateAttributes() {
            const grid = document.getElementById('attributes-grid');
            grid.innerHTML = '';
            ['FOR', 'CON', 'DES', 'MENTE', 'CAR'].forEach(attr => {
                const value = character.attributes[attr];
                const mod = value - 5;
                const card = document.createElement('div');
                card.className = 'attribute-card';
                card.innerHTML = `
                    <div class="text-xsmall">${attr}</div>
                    <div class="attribute-value">${value}</div>
                    <div class="attribute-mod">${mod >= 0 ? '+' + mod : mod}</div>
                `;
                grid.appendChild(card);
            });
        }

        function selectRace(race) {
            character.race = race;
            character.attributes = { ...race.atributos_base };
            character.raceCustomization = [];
            
            document.querySelectorAll('.race-card').forEach(c => c.classList.remove('selected'));
            event.currentTarget.classList.add('selected');
            document.getElementById('selected-race').textContent = race.nome;
            
            // Mostrar customiza√ß√£o
            showRaceCustomization(race);
            
            populateAttributes();
            updateCharacterSheet();
            updateCalculator();
            updateWeightSystem();
        }

        function showRaceCustomization(race) {
            const container = document.getElementById('race-customization');
            container.style.display = 'block';
            container.innerHTML = `
                <div class="customization-section">
                    <h4>üéØ Customiza√ß√£o</h4>
                    <p class="text-small">${race.bonus_customizacao_jogador}</p>
                    <div class="customization-options" id="customization-options">
                        ${generateCustomizationOptions(race)}
                    </div>
                </div>
            `;
            
            document.querySelectorAll('.customization-option').forEach(option => {
                option.onclick = function() {
                    handleCustomizationSelection(race, this.dataset.attribute);
                };
            });
        }

        function generateCustomizationOptions(race) {
            if (race.nome === "Humano") {
                return ['FOR', 'CON', 'DES', 'MENTE', 'CAR'].map(attr => `
                    <div class="customization-option" data-attribute="${attr}">
                        +1 ${attr}
                    </div>
                `).join('');
            } else {
                const options = race.bonus_customizacao_jogador.split(' ou ');
                return options.map(option => {
                    const attr = option.match(/[A-Z]{2,}/)[0];
                    return `
                        <div class="customization-option" data-attribute="${attr}">
                            ${option}
                        </div>
                    `;
                }).join('');
            }
        }

        function handleCustomizationSelection(race, selectedAttr) {
            if (race.nome === "Humano") {
                if (character.raceCustomization.includes(selectedAttr)) {
                    character.raceCustomization = character.raceCustomization.filter(attr => attr !== selectedAttr);
                } else if (character.raceCustomization.length < 2) {
                    character.raceCustomization.push(selectedAttr);
                } else {
                    alert('Humano pode selecionar apenas DUAS habilidades');
                    return;
                }
            } else {
                character.raceCustomization = [selectedAttr];
            }
            
            // Atualizar sele√ß√£o visual
            document.querySelectorAll('.customization-option').forEach(option => {
                option.classList.remove('selected');
                if (character.raceCustomization.includes(option.dataset.attribute)) {
                    option.classList.add('selected');
                }
            });
            
            applyRaceCustomization();
            populateAttributes();
            updateCharacterSheet();
            updateCalculator();
            updateWeightSystem();
        }

        function applyRaceCustomization() {
            if (!character.race) return;
            
            character.attributes = { ...character.race.atributos_base };
            
            character.raceCustomization.forEach(attr => {
                character.attributes[attr] += 1;
            });
            
            if (character.class) {
                Object.keys(character.class.bonus_atributos).forEach(attr => {
                    character.attributes[attr] += character.class.bonus_atributos[attr];
                });
            }
        }

        function selectClass(cls) {
            character.class = cls;
            applyRaceCustomization();
            
            document.querySelectorAll('.class-card').forEach(c => c.classList.remove('selected'));
            event.currentTarget.classList.add('selected');
            document.getElementById('selected-class').textContent = cls.nome;
            
            populateAttributes();
            updateCharacterSheet();
            updateCalculator();
            updateWeightSystem();
        }

        function updateCharacter() {
            character.armor = document.getElementById('armor-select').value;
            updateCharacterSheet();
        }

        function updateCharacterSheet() {
            if (character.race) {
                document.getElementById('sheet-race').textContent = character.race.nome;
            }
            if (character.class) {
                document.getElementById('sheet-class').textContent = character.class.nome;
                document.getElementById('special-rule-container').innerHTML = `
                    <div class="special-rule">
                        <strong>Habilidade:</strong> ${character.class.regra_unica}
                    </div>
                `;
            }
            
            // Calcular PV e CA
            const conMod = character.attributes.CON - 5;
            const pv = 10 + (character.class?.bonus_pv || 0) + conMod;
            const desMod = character.attributes.DES - 5;
            const armor = systemData.armaduras[character.armor];
            const ca = 10 + Math.min(desMod, armor.des_limite) + armor.bonus_ca;
            
            document.getElementById('sheet-pv').textContent = pv;
            document.getElementById('sheet-ca').textContent = ca;
        }

        // Calculadora
        function updateCalculator() {
            const raceName = document.getElementById('calc-race-select').value;
            const className = document.getElementById('calc-class-select').value;
            const armorType = document.getElementById('calc-armor-select').value;
            
            const race = systemData.racas.find(r => r.nome === raceName);
            const cls = systemData.classes.find(c => c.nome === className);
            const armor = systemData.armaduras[armorType];
            
            if (!race || !cls) return;
            
            // Calcular atributos
            let attributes = { ...race.atributos_base };
            Object.keys(cls.bonus_atributos).forEach(attr => {
                attributes[attr] += cls.bonus_atributos[attr];
            });
            
            // Calcular PV e CA
            const conMod = attributes.CON - 5;
            const pv = 10 + cls.bonus_pv + conMod;
            const desMod = attributes.DES - 5;
            const ca = 10 + Math.min(desMod, armor.des_limite) + armor.bonus_ca;
            
            document.getElementById('calc-pv-result').textContent = pv;
            document.getElementById('calc-ca-result').textContent = ca;
        }

        // Sistema de Peso
        function updateWeightSystem() {
            const str = character.attributes.FOR;
            const lmc = str * 7.5;
            const totalWeight = character.inventory.reduce((sum, item) => sum + item.peso, 0);
            
            document.getElementById('weight-str').textContent = str;
            document.getElementById('weight-lmc').textContent = lmc.toFixed(1);
            document.getElementById('weight-current').textContent = totalWeight.toFixed(1);
            
            // Status de carga
            let status, level, percentage;
            if (totalWeight > lmc) {
                status = "Im√≥vel"; level = "imovel"; percentage = 100;
            } else if (totalWeight > lmc * 2/3) {
                status = "Peso Pesado"; level = "pesado"; percentage = (totalWeight / lmc) * 100;
            } else if (totalWeight > lmc / 3) {
                status = "Peso M√©dio"; level = "medio"; percentage = (totalWeight / lmc) * 100;
            } else {
                status = "Peso Leve"; level = "leve"; percentage = (totalWeight / lmc) * 100;
            }
            
            document.getElementById('weight-status').textContent = status;
            const bar = document.getElementById('weight-bar');
            bar.className = 'weight-bar ' + level;
            bar.style.width = Math.min(percentage, 100) + '%';
            
            // Penalidades
            const penaltyElement = document.getElementById('weight-penalty');
            switch(level) {
                case 'leve': penaltyElement.textContent = "Sem penalidades"; break;
                case 'medio': penaltyElement.textContent = "-3m movimento, -2 em testes de DES"; break;
                case 'pesado': penaltyElement.textContent = "Move-se 1.5m, desvantagem em ataques"; break;
                case 'imovel': penaltyElement.textContent = "N√£o pode se mover"; break;
            }
            
            // Atualizar exemplos
            document.getElementById('weight-light-example').textContent = (lmc / 3).toFixed(1);
            document.getElementById('weight-medium-example').textContent = (lmc * 2 / 3).toFixed(1);
            document.getElementById('weight-heavy-example').textContent = lmc.toFixed(1);
            
            updateInventoryDisplay();
        }

        function updateInventoryDisplay() {
            const container = document.getElementById('inventory-items');
            container.innerHTML = '';
            
            if (character.inventory.length === 0) {
                container.innerHTML = `
                    <div class="empty-inventory">
                        <p>üéÅ Invent√°rio vazio</p>
                        <p class="text-xsmall mt-1">Adicione itens usando o formul√°rio abaixo</p>
                    </div>
                `;
            } else {
                character.inventory.forEach((item, index) => {
                    const div = document.createElement('div');
                    div.className = 'inventory-item';
                    div.innerHTML = `
                        <div>
                            <strong>${item.nome}</strong>
                            <div class="text-xsmall">${item.peso} kg</div>
                        </div>
                        <button onclick="removeItem(${index})">üóëÔ∏è</button>
                    `;
                    container.appendChild(div);
                });
            }
        }

        function addItem() {
            const name = document.getElementById('item-name').value.trim();
            const weight = parseFloat(document.getElementById('item-weight').value);
            
            if (name && weight > 0) {
                character.inventory.push({ nome: name, peso: weight });
                document.getElementById('item-name').value = '';
                document.getElementById('item-weight').value = '';
                updateWeightSystem();
            } else {
                alert('Por favor, preencha o nome e o peso do item corretamente!');
            }
        }

        function removeItem(index) {
            character.inventory.splice(index, 1);
            updateWeightSystem();
        }

        function createCharacter() {
            if (!character.race || !character.class) {
                alert('Selecione uma ra√ßa e classe primeiro!');
                return;
            }
            
            const name = prompt('Nome do personagem:', character.name);
            if (name) character.name = name;
            
            alert(`Personagem "${character.name}" criado!\n\nPV: ${document.getElementById('sheet-pv').textContent}\nCA: ${document.getElementById('sheet-ca').textContent}\n\nEm uma vers√£o completa, seria gerado um PDF.`);
        }
    </script>
</body>
</html>
